# 异常

CPSR:

低 19 位：控制位

1. I[7]：中断屏蔽位(Interrupt Mask)。当 I 置 1 时，屏蔽所有中断，当 I 置 0 时，允许所有中断。
2. F[6]：快速中断屏蔽位(Fast Interrupt Mask)。当 F 置 1 时，屏蔽快速中断，当 F 置 0 时，允许快速中断。
3. T[5]：Thumb 模式位。当 T 置 1 时，处理器处于 Thumb 模式，当 T 置 0 时，处理器处于 ARM 模式。
4. M[4:0]：处理器模式位。用于存储处理器的工作模式。
   | M[4:0] | 模式 | 说明 |
   | :----: | :-------------------: | :--------------------: |
   | 10000 | 用户模式(User) | 用于运行用户程序 |
   | 10001 | 快速中断模式(FIQ) | 用于处理快速中断 |
   | 10010 | 中断请求模式(IRQ) | 用于处理中断请求 |
   | 10011 | 超级管理模式(SVC) | 用于处理软件中断 |
   | 10110 | 监控模式(Monitor) | 用于处理调试 |
   | 10111 | 中止模式(Abort) | 用于处理数据访问异常 |
   | 11011 | 未定义模式(Undefined) | 用于处理未定义指令 |
   | 11111 | 系统模式(System) | 用于处理系统级别的软件 |

## Cortex-A7 中断

异常向量表是内核代码的一部分，位于内核代码的开头，用于存放异常处理程序的入口地址。

Cortex-A7 处理器的异常向量表位于 0xFFFF0000 处，其格式如下：

|    地址    |  异常类型  |                  说明                  |
| :--------: | :--------: | :------------------------------------: |
| 0xFFFF0000 |  重置异常  |    处理器复位时跳转到此处，SVC 模式    |
| 0xFFFF0004 | 未定义异常 |    未定义指令时跳转到此处，UND 模式    |
| 0xFFFF0008 |  软件中断  |  执行 swi 指令时跳转到此处，SVC 模式   |
| 0xFFFF000C |  中断请求  |   处理中断请求时跳转到此处，IRQ 模式   |
| 0xFFFF0010 |  快速中断  |   处理快速中断时跳转到此处，FIQ 模式   |
| 0xFFFF0018 |  中止模式  | 处理数据访问异常时跳转到此处，ABT 模式 |

### 重置异常

当处理器复位时，会跳转到 0xFFFF0000 处执行重置异常处理程序。

swi 指令用于产生软件中断，其格式为：

```assembly
swi #imm24
```

其中，imm24 为 24 位立即数，用于指定**软件中断的编号**。
